
# Server Configuration
server:
  port: 8080
  compression:
    enabled: true
  error:
    include-message: always
    include-binding-errors: always

# Spring Application Configuration
spring:
  application:
    name: weather-service

  # Cache Configuration
  cache:
    type: caffeine
    caffeine:
      spec: maximumSize=500,expireAfterWrite=300s

  # Jackson JSON Configuration
  jackson:
    default-property-inclusion: non_null
    serialization:
      write-dates-as-timestamps: false

# OpenWeatherMap API Configuration
openweathermap:
  # API Key from environment variable
#  api-key: ${OPENWEATHERMAP_API_KEY:}
  api-key: edd861148a1615919be9e09fa468233c


  # Base URL for OpenWeatherMap API
  base-url: https://api.openweathermap.org/data/2.5

  # HTTP Timeout Configuration
  timeout:
    connect: 2s  # Connection timeout: 2 seconds
    read: 5s     # Read timeout: 5 seconds

  # Retry Configuration for Rate Limiting (429)
  retry:
    max-attempts: 3        # Maximum retry attempts
    initial-delay: 1s      # Initial delay: 1 second (exponential backoff)

# Spring Boot Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,caches
      base-path: /actuator

  endpoint:
    health:
      show-details: when-authorized
      probes:
        enabled: true

  metrics:
    enable:
      jvm: true
      process: true
      system: true
    export:
      simple:
        enabled: true

# Logging Configuration
logging:
  level:
    # Root logging level
    root: INFO

    # Application-specific logging
    com.example.weatherapp: DEBUG

    # Spring WebClient logging (see HTTP requests/responses)
    org.springframework.web.reactive.function.client: DEBUG

    # Caffeine cache logging
    com.github.benmanes.caffeine: INFO

  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# SpringDoc OpenAPI (Swagger) Configuration
springdoc:
  api-docs:
    path: /api-docs
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    operations-sorter: method
    tags-sorter: alpha
  show-actuator: true
